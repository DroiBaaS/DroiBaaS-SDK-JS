function parseBigInt(n,t){return new JSBN.BigInteger(n,t)}function linebrk(n,t){for(var e="",r=0;r+t<n.length;)e+=n.substring(r,r+t)+"\n",r+=t;return e+n.substring(r,n.length)}function byte2Hex(n){return n<16?"0"+n.toString(16):n.toString(16)}function pkcs1pad2(n,t,e){if(t<n.length+11)throw new Error("Message too long for RSA");for(var r=new Array,l=n.length-1;l>=0&&t>0;){var i=n.charCodeAt(l--);i<128?r[--t]=i:i>127&&i<2048?(r[--t]=63&i|128,r[--t]=i>>6|192):(r[--t]=63&i|128,r[--t]=i>>6&63|128,r[--t]=i>>12|224)}r[--t]=0;for(var u=new RNG.SecureRandom,o=new Array;t>2;){if(o[0]=0,e)o[0]=9;else for(;0==o[0];)u.nextBytes(o);r[--t]=o[0]}return r[--t]=2,r[--t]=0,new JSBN.BigInteger(r)}function pkcs1pad2Byte(n,t,e){if(t<n.length+11)return alert("Message too long for RSA"),null;for(var r=new Array,l=n.length-1;l>=0&&t>0;)r[--t]=n[l--];r[--t]=0;for(var i=new RNG.SecureRandom,u=new Array;t>2;){if(u[0]=0,e)u[0]=9;else for(;0==u[0];)i.nextBytes(u);r[--t]=u[0]}return r[--t]=2,r[--t]=0,new JSBN.BigInteger(r)}function RSAKey(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function RSASetPublic(n,t){if(!(null!=n&&null!=t&&n.length>0&&t.length>0))throw new Error("Invalid RSA public key");this.n=parseBigInt(n,16),this.e=parseInt(t,16)}function RSADoPublic(n){return n.modPowInt(this.e,this.n)}function RSAEncrypt(n,t){var e=pkcs1pad2(n,this.n.bitLength()+7>>3,t);if(null==e)return null;var r=this.doPublic(e);if(null==r)return null;var l=r.toString(16);return 0==(1&l.length)?l:"0"+l}function RSAEncryptByte(n,t){var e=pkcs1pad2Byte(n,this.n.bitLength()+7>>3,t);if(null==e)return null;var r=this.doPublic(e);if(null==r)return null;var l=r.toString(16);return 0==(1&l.length)?l:"0"+l}var JSBN=require("./jsbn.js"),RNG=require("./rng.js");RSAKey.prototype.doPublic=RSADoPublic,RSAKey.prototype.setPublic=RSASetPublic,RSAKey.prototype.encrypt=RSAEncrypt,RSAKey.prototype.encryptByte=RSAEncryptByte,module.exports.RSAKey=RSAKey;